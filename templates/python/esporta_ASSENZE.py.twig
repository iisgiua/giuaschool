#!/usr/bin/env python
# -*- coding: utf-8 -*-


import os.path
from argolib import ArgoDriver


def main():

  ### classe = [anno, sezione, percorso]
  classe = ["{{ classe.anno }}", "{{ classe.sezione }}", "{{ percorso }}"]

  ### assenze[mese] = [ [alunno, [data1,data2,...]], ... ]
  assenze = {}

{% for mese in [9,10,11,12,1,2,3,4,5,6] %}
  assenze['{{ mese }}'] = [
{% for alunno,g in dati.assenze[mese] %}
      ["{{ (dati.alunni[alunno].cognome~' '~dati.alunni[alunno].nome)|raw }}", "{{ dati.alunni[alunno].dataNascita }}",
        [{% for giorno in g %}{{ giorno }},{% endfor %}] ],
{% endfor %}
    ]

{% endfor %}

  ### esegue programma
  ok = {}
{% for mese in [9,10,11,12,1,2,3,4,5,6] %}
  ok['{{ mese }}'] = False
{% endfor %}
  if os.path.isfile(classe[2]+"/"+classe[0]+classe[1]+"-OK.py"):
    execfile(classe[2]+"/"+classe[0]+classe[1]+"-OK.py")
  ad = ArgoDriver(debug="SCREEN", logpath=classe[2], logfile=classe[0]+classe[1]+"-GS")
  ad.importaAssenze(classe[0], classe[1], assenze, ok, {{ anno_inizio }})


if __name__ == "__main__":
  main()

