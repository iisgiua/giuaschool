#!/usr/bin/env python
# -*- coding: utf-8 -*-


from argolib import ArgoDriver


def main():

  ### classe = [anno, sezione, percorso]
  classe = ["{{ classe.anno }}", "{{ classe.sezione }}", "{{ percorso }}"]

  ### voti[materia] = [ [alunno, nascita, voto, assenze], ... ]
  voti = {}
{% for materia,m in dati.materie %}
  voti["{{ m.nome|raw }}"] = [
{% for alunno,a in dati.alunni %}
{% if m.tipo == 'R' %}
{% if a.religione != 'S' %}
      ["{{ (a.cognome~' '~a.nome)|raw }}", "{{ a.dataNascita }}", "", ""],
{% else %}
      ["{{ (a.cognome~' '~a.nome)|raw }}", "{{ a.dataNascita }}", "{{ dati.voti[alunno][materia].unico }}", "{{ dati.voti[alunno][materia].assenze }}"],
{% endif %}
{% elseif m.tipo == 'C' %}
      ["{{ (a.cognome~' '~a.nome)|raw }}", "{{ a.dataNascita }}", "{{ dati.voti[alunno][materia].unico }}", ""],
{% else %}
      ["{{ (a.cognome~' '~a.nome)|raw }}", "{{ a.dataNascita }}", "{{ dati.voti[alunno][materia].unico }}", "{{ dati.voti[alunno][materia].assenze }}"],
{% endif %}
{% endfor %}
    ]
{% endfor %}

  ### esito = [ [alunno, nascita, media], ... ]
  esito = [
{% for alunno,a in dati.alunni %}
      ["{{ (a.cognome~' '~a.nome)|raw }}", "{{ a.dataNascita }}", "{{ dati.medie[alunno] }}"],
{% endfor %}
    ]

  ### esegue programma
  ad = ArgoDriver(debug="SCREEN", logpath=classe[2], logfile=classe[0]+classe[1]+"-GS")
  ad.importaTrimestre(classe[0], classe[1], voti, esito)
  ad.controllaTrimestre(classe[0], classe[1], voti, esito)


if __name__ == "__main__":
  main()

